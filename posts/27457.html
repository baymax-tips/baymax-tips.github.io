<!DOCTYPE HTML><html lang="zh-CN"><head><meta charset="utf-8"><meta name="keywords" content="Docker入门系列  4. Docker 容器网络的概念及网络配置 网桥网络"><meta name="description" content=""><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><meta name="renderer" content="webkit|ie-stand|ie-comp"><meta name="mobile-web-app-capable" content="yes"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-167468047-1"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-167468047-1")</script><title>Docker入门系列 4. Docker 容器网络的概念及网络配置 网桥网络 | 小白笔记</title><link rel="icon" type="image/png" href="/favicon.png"><link rel="stylesheet" href="/libs/awesome/css/all.css"><link rel="stylesheet" href="/libs/materialize/materialize.min.css"><link rel="stylesheet" href="/libs/aos/aos.css"><link rel="stylesheet" href="/libs/animate/animate.min.css"><link rel="stylesheet" href="/libs/lightGallery/css/lightgallery.min.css"><link rel="stylesheet" href="/css/matery.css"><link rel="stylesheet" href="/css/my.css"><script src="/libs/jquery/jquery.min.js"></script><meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/atom.xml" title="小白笔记" type="application/atom+xml"><link rel="stylesheet" href="/css/prism-tomorrow.css"><link rel="stylesheet" href="/css/prism-line-numbers.css"></head><body><header class="navbar-fixed"><nav id="headNav" class="bg-color nav-transparent"><div id="navContainer" class="nav-wrapper container"><div class="brand-logo"><a href="/" class="waves-effect waves-light"><div><img src="/medias/loading.gif" data-original="/medias/logo.png" class="logo-img" alt="LOGO"> <span class="logo-span">小白笔记</span></div></a></div><a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a><ul class="right nav-menu"><li class="hide-on-med-and-down nav-item"><a href="/" class="waves-effect waves-light"><i class="fas fa-home" style="zoom:.6"></i> <span>首页</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/tags" class="waves-effect waves-light"><i class="fas fa-tags" style="zoom:.6"></i> <span>标签</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/categories" class="waves-effect waves-light"><i class="fas fa-bookmark" style="zoom:.6"></i> <span>分类</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/archives" class="waves-effect waves-light"><i class="fas fa-archive" style="zoom:.6"></i> <span>归档</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/about" class="waves-effect waves-light"><i class="fas fa-user-circle" style="zoom:.6"></i> <span>关于</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/contact" class="waves-effect waves-light"><i class="fas fa-comments" style="zoom:.6"></i> <span>留言板</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/friends" class="waves-effect waves-light"><i class="fas fa-address-book" style="zoom:.6"></i> <span>友情链接</span></a></li><li><a href="#searchModal" class="modal-trigger waves-effect waves-light"><i id="searchIcon" class="fas fa-search" title="搜索" style="zoom:.85"></i></a></li></ul><div id="mobile-nav" class="side-nav sidenav"><div class="mobile-head bg-color"><img src="/medias/loading.gif" data-original="/medias/logo.png" class="logo-img circle responsive-img"><div class="logo-name">小白笔记</div><div class="logo-desc">Never really desperate, only the lost of the soul.</div></div><ul class="menu-list mobile-menu-list"><li class="m-nav-item"><a href="/" class="waves-effect waves-light"><i class="fa-fw fas fa-home"></i> 首页</a></li><li class="m-nav-item"><a href="/tags" class="waves-effect waves-light"><i class="fa-fw fas fa-tags"></i> 标签</a></li><li class="m-nav-item"><a href="/categories" class="waves-effect waves-light"><i class="fa-fw fas fa-bookmark"></i> 分类</a></li><li class="m-nav-item"><a href="/archives" class="waves-effect waves-light"><i class="fa-fw fas fa-archive"></i> 归档</a></li><li class="m-nav-item"><a href="/about" class="waves-effect waves-light"><i class="fa-fw fas fa-user-circle"></i> 关于</a></li><li class="m-nav-item"><a href="/contact" class="waves-effect waves-light"><i class="fa-fw fas fa-comments"></i> 留言板</a></li><li class="m-nav-item"><a href="/friends" class="waves-effect waves-light"><i class="fa-fw fas fa-address-book"></i> 友情链接</a></li><li><div class="divider"></div></li><li><a href="https://github.com/baymax-tips" class="waves-effect waves-light" target="_blank"><i class="fab fa-github-square fa-fw"></i> Fork Me</a></li></ul></div></div><style>.nav-transparent .github-corner{display:none!important}.github-corner{position:absolute;z-index:10;top:0;right:0;border:0;transform:scale(1.1)}.github-corner svg{color:#0f9d58;fill:#fff;height:64px;width:64px}.github-corner:hover .octo-arm{animation:a .56s ease-in-out}.github-corner .octo-arm{animation:none}@keyframes a{0%,to{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}</style><a href="https://github.com/baymax-tips" class="github-corner tooltipped hide-on-med-and-down" target="_blank" data-tooltip="Fork Me" data-position="left" data-delay="50"><svg viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a></nav></header><div class="bg-cover pd-header post-cover" style="background-image:url(/medias/featureimages/21.jpg)"><div class="container" style="right:0;left:0"><div class="row"><div class="col s12 m12 l12"><div class="brand"><h1 class="description center-align post-title">Docker入门系列 4. Docker 容器网络的概念及网络配置 网桥网络</h1></div></div></div></div></div><main class="post-container content"><link rel="stylesheet" href="/libs/tocbot/tocbot.css"><style>#articleContent h1::before,#articleContent h2::before,#articleContent h3::before,#articleContent h4::before,#articleContent h5::before,#articleContent h6::before{display:block;content:" ";height:100px;margin-top:-100px;visibility:hidden}#articleContent :focus{outline:0}.toc-fixed{position:fixed;top:64px}.toc-widget{width:345px;padding-left:20px}.toc-widget .toc-title{margin:35px 0 15px 0;padding-left:17px;font-size:1.5rem;font-weight:700;line-height:1.5rem}.toc-widget ol{padding:0;list-style:none}#toc-content{height:calc(100vh - 250px);overflow:auto}#toc-content ol{padding-left:10px}#toc-content ol li{padding-left:10px}#toc-content .toc-link:hover{color:#42b983;font-weight:700;text-decoration:underline}#toc-content .toc-link::before{background-color:transparent;max-height:25px;position:absolute;right:23.5vw;display:block}#toc-content .is-active-link{color:#42b983}#floating-toc-btn{position:fixed;right:15px;bottom:76px;padding-top:15px;margin-bottom:0;z-index:998}#floating-toc-btn .btn-floating{width:48px;height:48px}#floating-toc-btn .btn-floating i{line-height:48px;font-size:1.4rem}</style><div class="row"><div id="main-content" class="col s12 m12 l9"><div id="artDetail"><div class="card"><div class="card-content article-info"><div class="row tag-cate"><div class="col s7"><div class="article-tag"><a href="/tags/Docker/"><span class="chip bg-color">Docker</span></a> <a href="/tags/%E5%AE%B9%E5%99%A8%E6%9C%8D%E5%8A%A1/"><span class="chip bg-color">容器服务</span></a></div></div><div class="col s5 right-align"><div class="post-cate"><i class="fas fa-bookmark fa-fw icon-category"></i> <a href="/categories/%E5%AE%B9%E5%99%A8%E6%9C%8D%E5%8A%A1/" class="post-category">容器服务</a></div></div></div><div class="post-info"><div class="post-date info-break-policy"><i class="far fa-calendar-minus fa-fw"></i> 发布日期:&nbsp;&nbsp; 2020-05-22</div><div class="info-break-policy"><i class="far fa-file-word fa-fw"></i> 文章字数:&nbsp;&nbsp; 5.5k</div><div class="info-break-policy"><i class="far fa-clock fa-fw"></i> 阅读时长:&nbsp;&nbsp; 24 分</div><div id="busuanzi_container_page_pv" class="info-break-policy"><i class="far fa-eye fa-fw"></i> 阅读次数:&nbsp;&nbsp;<span id="busuanzi_value_page_pv"></span></div></div></div><hr class="clearfix"><div class="card-content article-card-content"><div id="articleContent"><h2 id="1-使用网桥网络"><a href="#1-使用网桥网络" class="headerlink" title="1. 使用网桥网络"></a>1. 使用网桥网络</h2><p>就网络而言，桥接网络是在网段之间转发流量的链路层设备。桥接器可以是在主机内核中运行的硬件设备或软件设备。</p><p>就 Docker 而言，桥接网络使用一个软件桥接器，它允许连接到同一桥接网络的容器进行通信，同时提供与未连接到桥接网络的容器的隔离。 Docker 桥接驱动程序在主机上自动安装规则，使不同桥接网络上的容器不能直接相互通信。</p><p>桥接网络应用于运行在同一个 Docker 守护进程主机上的容器。 对于运行在不同 Docker 守护进程主机上的容器之间的通信，您可以在操作系统级别管理路由，也可以使用<code>覆盖网络</code>。</p><p>启动Docker时，会自动创建一个<code>默认的桥接网络</code>（也称为<code>bridge</code>），除非另有说明，否则新启动的容器将连接到它。您还可以创建用户定义的自定义网桥网络。<strong>用户定义的网桥网络优于默认<code>bridge</code> 网络</strong>。</p><h3 id="1-1-用户定义的网桥和默认网桥之间的区别"><a href="#1-1-用户定义的网桥和默认网桥之间的区别" class="headerlink" title="1.1 用户定义的网桥和默认网桥之间的区别"></a>1.1 用户定义的网桥和默认网桥之间的区别</h3><ul><li><p><strong>用户定义的桥接提供了更好的隔离和容器化应用程序之间的互操作性。</strong></p><p>连接到相同的用户定义桥接网络的容器自动将所有端口相互公开，而不向外部世界公开端口。 这使得容器化的应用程序可以轻松地相互通信，而不会意外地打开对外部世界的访问。</p><p>想象一下，一个应用程序有一个 web 前端和一个数据库后端。 外部世界需要访问 web 前端(可能在端口80上) ，但只有后端本身需要访问数据库主机和端口。 使用用户定义的网桥，只需要打开 web 端口，数据库应用程序不需要打开任何端口，因为 web 前端可以通过用户定义的网桥到达它。</p><blockquote><p>如果在缺省桥接网络上运行相同的应用程序堆栈，则需要同时打开 web 端口和数据库端口，并为每个端口使用-p 或 – publish 标志。 这意味着 Docker 主机需要通过其他方式阻止对数据库端口的访问。</p></blockquote></li><li><p><strong>用户定义的网桥可在容器之间提供自动DNS解析。</strong></p><p>默认桥网络上的容器只能通过 IP 地址访问彼此，除非您使用 – link 选项，这被认为是遗留的。 在用户定义的网桥网络上，容器可以通过名称或别名相互解析。</p><p>想象一下与前一点相同的应用程序，它有一个 web 前端和一个数据库后端。 如果你调用你的容器 web 和 db，web 容器可以连接到 db 容器，不管 Docker 主机上运行的应用程序堆栈是什么。</p><blockquote><p>如果在默认网桥网络上运行相同的应用程序堆栈，则需要在容器之间手动创建链接（使用旧式–link 标志）。这些链接需要双向创建，因此您可以看到，要进行通信的容器超过两个，这将变得很复杂。另外，您可以操纵/etc/hosts容器中的文件，但这会产生难以调试的问题。</p></blockquote></li><li><p><strong>容器可以随时随地从用户定义的网络连接和分离。</strong></p><blockquote><p>在容器的生命周期内，您可以即时将其与用户定义的网络连接或断开连接。要从默认桥接网络中删除容器，您需要停止容器并使用其他网络选项重新创建它。</p></blockquote></li><li><p><strong>每个用户定义的网络都会创建一个可配置的网桥。</strong></p><p>如果您的容器使用默认桥接网络，则可以对其进行配置，但是所有容器都使用相同的设置，例如MTU和iptables规则。另外，配置默认桥接网络发生在Docker本身之外，并且需要重新启动Docker。</p><blockquote><p>使用 <code>docker network create</code> 创建和配置用户定义的桥接网络。 如果不同的应用程序组有不同的网络需求，您可以在创建用户定义的桥接时分别配置它。</p></blockquote></li><li><p><strong>默认网桥网络上的链接容器共享环境变量。</strong></p><p>最初，在两个容器之间共享环境变量的唯一方法是使用 – link 标志将它们链接起来。 这种类型的变量共享在用户定义的网络中是不可能的。 但是，有一些共享环境变量的优秀方法。 以下是一些建议:</p><ul><li><p>多个容器可以使用Docker卷挂载包含共享信息的文件或目录。</p></li><li><p>使用可以一起启动多个容器docker-compose，并且compose文件可以定义共享变量。</p></li><li><p>您可以使用群体服务代替独立容器，并利用共享的<code>secrets</code>和 <code>configs</code>。</p></li></ul></li></ul><p>连接到同一个用户定义的桥接网络的容器有效地将所有端口相互暴露。 对于不同网络上的容器或非 docker 主机可以访问的端口，必须使用 -p 或 – publish 标志发布该端口。</p><h3 id="1-2-管理用户定义的网桥"><a href="#1-2-管理用户定义的网桥" class="headerlink" title="1.2 管理用户定义的网桥"></a>1.2 管理用户定义的网桥</h3><p>使用该docker network create命令创建用户定义的网桥网络。</p><pre class="line-numbers language-bash"><code class="language-bash">docker network create my-net<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>您可以指定子网，IP地址范围，网关和其他选项。</p><p>使用<code>docker network rm</code>命令删除用户定义的网桥网络。如果容器当前已连接到网络， 请先断开它们。</p><pre class="line-numbers language-bash"><code class="language-bash">docker network <span class="token function">rm</span> my-net<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p><strong><span class="github-emoji" style="color:transparent;background:no-repeat url(https://github.githubassets.com/images/icons/emoji/unicode/26a0.png?v8) center/contain" data-src="https://github.githubassets.com/images/icons/emoji/unicode/26a0.png?v8">⚠</span> 到底发生了什么事？</strong></p><p>当您创建或删除用户定义的桥接或从用户定义的桥接连接或断开容器时，Docker 使用特定于操作系统的工具来管理底层网络基础设施(例如添加或删除桥接设备或在 Linux 上配置 iptables 规则)。 这些细节应该被视为实现细节。 让 Docker 为您管理用户定义的网络。</p></blockquote><h3 id="1-3-将容器连接到用户定义的网桥"><a href="#1-3-将容器连接到用户定义的网桥" class="headerlink" title="1.3 将容器连接到用户定义的网桥"></a>1.3 将容器连接到用户定义的网桥</h3><p>创建新容器时，可以指定一个或多个网络标志。 此示例将 Nginx 容器连接到 <code>my-net</code> 网络。 它还将容器中的端口80发布到 Docker 主机上的端口8080，这样外部客户机就可以访问该端口。 连接到 <code>my-net</code> 网络的任何其他容器都可以访问 <code>my-nginx</code> 容器上的所有端口，反之亦然。</p><pre class="line-numbers language-bash"><code class="language-bash">docker create --name my-nginx \
  --network my-net \
  --publish 8080:80 \
  nginx:latest<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>若要将正在运行的容器连接到现有的用户定义桥接器，请使用 <code>docker network connect</code> 命令。 下面的命令将一个已经运行的 <code>my-nginx</code> 容器连接到一个已经存在的 <code>my-net</code> 网络:</p><pre class="line-numbers language-bash"><code class="language-bash">docker network connect my-net my-nginx<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="1-4-断开容器与用户定义的网桥的连接"><a href="#1-4-断开容器与用户定义的网桥的连接" class="headerlink" title="1.4 断开容器与用户定义的网桥的连接"></a>1.4 断开容器与用户定义的网桥的连接</h3><p>若要断开正在运行的容器与用户定义的桥接器的连接，请使用 <code>docker network disconnect</code> 命令。 下面的命令断开 <code>my-nginx</code> 容器与 <code>my-net</code> 网络的连接。</p><pre class="line-numbers language-bash"><code class="language-bash">docker network disconnect my-net my-nginx<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="1-5-使用IPv6"><a href="#1-5-使用IPv6" class="headerlink" title="1.5 使用IPv6"></a>1.5 使用IPv6</h3><p>如果您需要对 Docker 容器的 IPv6支持，那么在创建任何 IPv6网络或为容器分配 IPv6地址之前，您需要启用 Docker 守护进程上的选项并重新加载其配置。</p><p>创建网络时，可以指定 <code>--ipv6</code>标志以启用 IPv6。 你不能选择性地禁用默认桥接网络的 IPv6支持。</p><h3 id="1-6-启用从Docker容器到外界的转发"><a href="#1-6-启用从Docker容器到外界的转发" class="headerlink" title="1.6 启用从Docker容器到外界的转发"></a>1.6 启用从Docker容器到外界的转发</h3><p>默认情况下，来自连接到默认网桥网络的容器的流量 不会转发到外界。要启用转发，您需要更改两个设置。这些不是Docker命令，它们会影响Docker主机的内核。</p><ol><li><p>配置Linux内核以允许IP转发。</p><pre class="line-numbers language-bash"><code class="language-bash">sysctl net.ipv4.conf.all.forwarding<span class="token operator">=</span>1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>将策略的iptables FORWARD策略从更改DROP为 ACCEPT。</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">sudo</span> iptables -P FORWARD ACCEPT<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li></ol><p>这些设置不会在重新启动后持续存在，因此您可能需要将它们添加到启动脚本中。</p><h3 id="1-7-使用默认的桥接网络"><a href="#1-7-使用默认的桥接网络" class="headerlink" title="1.7 使用默认的桥接网络"></a>1.7 使用默认的桥接网络</h3><p>默认<code>bridge</code>网络被认为是Docker的遗留细节，不建议用于生产环境。对其进行配置是手动操作，并且存在 技术缺陷。</p><h4 id="将容器连接到默认网桥网络"><a href="#将容器连接到默认网桥网络" class="headerlink" title="将容器连接到默认网桥网络"></a>将容器连接到默认网桥网络</h4><p>如果没有使用 – network 标志指定网络，并且指定了网络驱动程序，则默认情况下容器将连接到默认桥接网络。 连接到默认桥接网络的容器可以通信，但只能通过 IP 地址通信，除非使用遗留的 – link 标志链接它们。</p><h4 id="配置默认网桥网络"><a href="#配置默认网桥网络" class="headerlink" title="配置默认网桥网络"></a>配置默认网桥网络</h4><p>要配置默认的桥接网络，可以在 daemon.json 中指定选项。 下面是一个指定了几个选项的 daemon.json 示例。 只指定需要自定义的设置。</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token punctuation">{</span>
  <span class="token string">"bip"</span><span class="token keyword">:</span> <span class="token string">"192.168.1.5/24"</span>,
  <span class="token string">"fixed-cidr"</span><span class="token keyword">:</span> <span class="token string">"192.168.1.5/25"</span>,
  <span class="token string">"fixed-cidr-v6"</span><span class="token keyword">:</span> <span class="token string">"2001:db8::/64"</span>,
  <span class="token string">"mtu"</span><span class="token keyword">:</span> 1500,
  <span class="token string">"default-gateway"</span><span class="token keyword">:</span> <span class="token string">"10.20.1.1"</span>,
  <span class="token string">"default-gateway-v6"</span><span class="token keyword">:</span> <span class="token string">"2001:db8:abcd::89"</span>,
  <span class="token string">"dns"</span><span class="token keyword">:</span> <span class="token punctuation">[</span><span class="token string">"10.20.1.2"</span>,<span class="token string">"10.20.1.3"</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>重新启动Docker以使更改生效。</p><h4 id="将IPv6与默认桥接网络一起使用"><a href="#将IPv6与默认桥接网络一起使用" class="headerlink" title="将IPv6与默认桥接网络一起使用"></a>将IPv6与默认桥接网络一起使用</h4><p>如果您为 IPv6支持配置 Docker (请参阅使用 IPv6) ，默认桥接网络也会自动为 IPv6配置。 与用户定义的网桥不同，您不能在缺省网桥上有选择地禁用 IPv6。</p><h2 id="2-实践练习-与独立容器联网"><a href="#2-实践练习-与独立容器联网" class="headerlink" title="2. 实践练习 与独立容器联网"></a>2. 实践练习 与独立容器联网</h2><ul><li><p>使<code>用默认桥接网络</code> 演示如何使用 Docker 为您自动设置的默认桥网络。 这个网络不是生产系统的最佳选择。</p></li><li><p><code>使用用户定义的桥接网络</code> 演示了如何创建和使用自己的定制桥接网络，以连接运行在同一个 Docker 主机上的容器。 建议在生产环境中运行的独立容器使用这种方法。</p></li></ul><h3 id="2-1-使用默认的桥接网络"><a href="#2-1-使用默认的桥接网络" class="headerlink" title="2.1 使用默认的桥接网络"></a>2.1 使用默认的桥接网络</h3><p>在本例中，您在同一个 Docker 主机上启动两个不同的 alpine 容器，并进行一些测试以了解它们如何彼此通信。 您需要安装并运行 Docker。</p><ol><li><p>打开终端窗口。 在你做任何事情之前列出当前的网络。 如果您从未在这个 Docker 守护进程上添加过网络或初始化过一个群，下面是您应该看到的内容。 你可能会看到不同的网络，但是你至少应该看到这些(网络 id 不同) :</p><pre class="line-numbers language-bash"><code class="language-bash">
$ docker network <span class="token function">ls</span>

NETWORK ID          NAME                DRIVER              SCOPE
17e324f45964        bridge              bridge              local
6ed54d316334        host                host                local
7092879f2cc8        none                null                local
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>列出了<code>bridge</code>、<code>host</code>和 <code>none</code>。 后两者不是完全成熟的网络，但用于启动直接连接到 Docker 守护进程主机的网络堆栈的容器，或者启动没有网络设备的容器。 本教程将把两个容器连接到桥接网络。</p></li><li><p>启动两个<code>alpine</code>运行的容器<code>ash</code>，这是<code>alpine</code>的默认<code>shell</code>程序，而不是bash。<code>-dit</code>标志意味着启动分离的容器(在后台），交互式的容器(可以在其中键入内容)和 TTY (这样您就可以看到输入和输出)。因为是分离启动的，所以不会马上连接到容器。 相反，容器的 ID 将被打印出来。 因为您没有指定任何 <code>--network</code>标志，因此容器将连接到默认<code>bridge</code>网络。</p><pre class="line-numbers language-bash"><code class="language-bash">
$ docker run -dit --name alpine1 alpine ash

$ docker run -dit --name alpine2 alpine ash
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>检查两个容器是否确实已启动：</p><pre class="line-numbers language-bash"><code class="language-bash">$ docker container <span class="token function">ls</span>

CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES
602dbf1edc81        alpine              <span class="token string">"ash"</span>               4 seconds ago       Up 3 seconds                            alpine2
da33b7aa74b0        alpine              <span class="token string">"ash"</span>               17 seconds ago      Up 16 seconds                           alpine1
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>检查bridge网络以查看连接了哪些容器。</p><pre class="line-numbers language-bash"><code class="language-bash">$ docker network inspect bridge

<span class="token punctuation">[</span>
 <span class="token punctuation">{</span>
     <span class="token string">"Name"</span><span class="token keyword">:</span> <span class="token string">"bridge"</span>,
     <span class="token string">"Id"</span><span class="token keyword">:</span> <span class="token string">"17e324f459648a9baaea32b248d3884da102dde19396c25b30ec800068ce6b10"</span>,
     <span class="token string">"Created"</span><span class="token keyword">:</span> <span class="token string">"2017-06-22T20:27:43.826654485Z"</span>,
     <span class="token string">"Scope"</span><span class="token keyword">:</span> <span class="token string">"local"</span>,
     <span class="token string">"Driver"</span><span class="token keyword">:</span> <span class="token string">"bridge"</span>,
     <span class="token string">"EnableIPv6"</span><span class="token keyword">:</span> false,
     <span class="token string">"IPAM"</span><span class="token keyword">:</span> <span class="token punctuation">{</span>
         <span class="token string">"Driver"</span><span class="token keyword">:</span> <span class="token string">"default"</span>,
         <span class="token string">"Options"</span><span class="token keyword">:</span> null,
         <span class="token string">"Config"</span><span class="token keyword">:</span> <span class="token punctuation">[</span>
             <span class="token punctuation">{</span>
                 <span class="token string">"Subnet"</span><span class="token keyword">:</span> <span class="token string">"172.17.0.0/16"</span>,
                 <span class="token string">"Gateway"</span><span class="token keyword">:</span> <span class="token string">"172.17.0.1"</span>
             <span class="token punctuation">}</span>
         <span class="token punctuation">]</span>
     <span class="token punctuation">}</span>,
     <span class="token string">"Internal"</span><span class="token keyword">:</span> false,
     <span class="token string">"Attachable"</span><span class="token keyword">:</span> false,
     <span class="token string">"Containers"</span><span class="token keyword">:</span> <span class="token punctuation">{</span>
         <span class="token string">"602dbf1edc81813304b6cf0a647e65333dc6fe6ee6ed572dc0f686a3307c6a2c"</span><span class="token keyword">:</span> <span class="token punctuation">{</span>
             <span class="token string">"Name"</span><span class="token keyword">:</span> <span class="token string">"alpine2"</span>,
             <span class="token string">"EndpointID"</span><span class="token keyword">:</span> <span class="token string">"03b6aafb7ca4d7e531e292901b43719c0e34cc7eef565b38a6bf84acf50f38cd"</span>,
             <span class="token string">"MacAddress"</span><span class="token keyword">:</span> <span class="token string">"02:42:ac:11:00:03"</span>,
             <span class="token string">"IPv4Address"</span><span class="token keyword">:</span> <span class="token string">"172.17.0.3/16"</span>,
             <span class="token string">"IPv6Address"</span><span class="token keyword">:</span> <span class="token string">""</span>
         <span class="token punctuation">}</span>,
         <span class="token string">"da33b7aa74b0bf3bda3ebd502d404320ca112a268aafe05b4851d1e3312ed168"</span><span class="token keyword">:</span> <span class="token punctuation">{</span>
             <span class="token string">"Name"</span><span class="token keyword">:</span> <span class="token string">"alpine1"</span>,
             <span class="token string">"EndpointID"</span><span class="token keyword">:</span> <span class="token string">"46c044a645d6afc42ddd7857d19e9dcfb89ad790afb5c239a35ac0af5e8a5bc5"</span>,
             <span class="token string">"MacAddress"</span><span class="token keyword">:</span> <span class="token string">"02:42:ac:11:00:02"</span>,
             <span class="token string">"IPv4Address"</span><span class="token keyword">:</span> <span class="token string">"172.17.0.2/16"</span>,
             <span class="token string">"IPv6Address"</span><span class="token keyword">:</span> <span class="token string">""</span>
         <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>,
     <span class="token string">"Options"</span><span class="token keyword">:</span> <span class="token punctuation">{</span>
         <span class="token string">"com.docker.network.bridge.default_bridge"</span><span class="token keyword">:</span> <span class="token string">"true"</span>,
         <span class="token string">"com.docker.network.bridge.enable_icc"</span><span class="token keyword">:</span> <span class="token string">"true"</span>,
         <span class="token string">"com.docker.network.bridge.enable_ip_masquerade"</span><span class="token keyword">:</span> <span class="token string">"true"</span>,
         <span class="token string">"com.docker.network.bridge.host_binding_ipv4"</span><span class="token keyword">:</span> <span class="token string">"0.0.0.0"</span>,
         <span class="token string">"com.docker.network.bridge.name"</span><span class="token keyword">:</span> <span class="token string">"docker0"</span>,
         <span class="token string">"com.docker.network.driver.mtu"</span><span class="token keyword">:</span> <span class="token string">"1500"</span>
     <span class="token punctuation">}</span>,
     <span class="token string">"Labels"</span><span class="token keyword">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>s在顶部附近，<code>bridge</code>列出了有关网络的信息，包括Docker主机和<code>bridge</code> 网络之间的网关的IP地址（<code>172.17.0.1</code>）。在该<code>Containers</code>键下，列出了每个已连接的容器以及有关其IP地址的信息（<code>172.17.0.2</code>for <code>alpine1</code>和<code>172.17.0.3</code>for <code>alpine2</code>）。</p></blockquote></li><li><p>容器在后台运行。使用docker attach 命令连接到alpine1。</p><pre class="line-numbers language-bash"><code class="language-bash">$ docker attach alpine1

/ <span class="token comment" spellcheck="true">#</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>提示将更改为 # ，以指示您是容器中的根用户。 使用 <code>ip addr show</code> 命令显示 <code>alpine1</code>的网络接口，因为它们从容器内部观察:</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># ip addr show</span>

1: lo: <span class="token operator">&lt;</span>LOOPBACK,UP,LOWER_UP<span class="token operator">></span> mtu 65536 qdisc noqueue state UNKNOWN qlen 1
 link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
 inet 127.0.0.1/8 scope host lo
   valid_lft forever preferred_lft forever
 inet6 ::1/128 scope host
   valid_lft forever preferred_lft forever
27: eth0@if28: <span class="token operator">&lt;</span>BROADCAST,MULTICAST,UP,LOWER_UP,M-DOWN<span class="token operator">></span> mtu 1500 qdisc noqueue state UP
 link/ether 02:42:ac:11:00:02 brd ff:ff:ff:ff:ff:ff
 inet 172.17.0.2/16 scope global eth0
   valid_lft forever preferred_lft forever
 inet6 fe80::42:acff:fe11:2/64 scope <span class="token function">link</span>
   valid_lft forever preferred_lft forever<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>第一个接口是环回设备。 暂时忽略它。 请注意，第二个接口的 IP 地址为<code>172.17.0.2</code>，与前面步骤中显示的 <code>alpine1</code>的地址相同。</p></li><li><p>在 <code>alpine1</code>内部，确保你可以通过 <code>ping google.com</code>连接到互联网。该 <code>-c2</code>标志将命令限制为两次ping 尝试。</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># ping -c 2 google.com</span>

PING google.com <span class="token punctuation">(</span>172.217.3.174<span class="token punctuation">)</span>: 56 data bytes
64 bytes from 172.217.3.174: seq<span class="token operator">=</span>0 ttl<span class="token operator">=</span>41 time<span class="token operator">=</span>9.841 ms
64 bytes from 172.217.3.174: seq<span class="token operator">=</span>1 ttl<span class="token operator">=</span>41 time<span class="token operator">=</span>9.897 ms

\--- google.com <span class="token function">ping</span> statistics ---
2 packets transmitted, 2 packets received, 0% packet loss
round-trip min/avg/max <span class="token operator">=</span> 9.841/9.869/9.897 ms
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>现在尝试 ping 第二个容器，首先，ping 它的 IP 地址，<code>172.17.0.3</code>:</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># ping -c 2 172.17.0.3</span>

PING 172.17.0.3 <span class="token punctuation">(</span>172.17.0.3<span class="token punctuation">)</span>: 56 data bytes
64 bytes from 172.17.0.3: seq<span class="token operator">=</span>0 ttl<span class="token operator">=</span>64 time<span class="token operator">=</span>0.086 ms
64 bytes from 172.17.0.3: seq<span class="token operator">=</span>1 ttl<span class="token operator">=</span>64 time<span class="token operator">=</span>0.094 ms

\--- 172.17.0.3 <span class="token function">ping</span> statistics ---
2 packets transmitted, 2 packets received, 0% packet loss
round-trip min/avg/max <span class="token operator">=</span> 0.086/0.090/0.094 ms<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>成功。接下来，尝试按容器名称 <code>ping alpine2</code>容器。这将失败。</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># ping -c 2 alpine2</span>

ping: bad address <span class="token string">'alpine2'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li><li><p>通过使用分离序列，<code>CTRL + p</code> <code>CTRL + q</code> (按住 CTRL，输入 p 后跟 q)从 <code>alpine1</code>中分离，而不停止它。 如果你愿意，连接到 <code>alpine2</code>，重复步骤4,5,6，用 <code>alpine1</code>代替 <code>alpine2</code>。</p></li><li><p>停止并移走两个容器。</p><pre class="line-numbers language-bash"><code class="language-bash">$ docker container stop alpine1 alpine2
$ docker container <span class="token function">rm</span> alpine1 alpine2 <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li></ol><blockquote><p>请记住，生产环境中不推荐使用默认的网桥网络。</p></blockquote><h3 id="2-2-使用用户定义的网桥"><a href="#2-2-使用用户定义的网桥" class="headerlink" title="2.2 使用用户定义的网桥"></a>2.2 使用用户定义的网桥</h3><p>在这个例子中，我们再次启动两个 <code>alpine</code> 容器，但是将它们附加到我们已经创建的用户定义的网络 <code>alpine-net</code> 中。 这些容器根本没有连接到缺省<code>网桥网络</code>。 然后我们开始第三个<code>alpine</code>容器，连接到<code>桥接网络</code>，但不连接到<code>lpine-net</code>，和第四个<code>alpine</code>容器，同事连接到这两个网络。</p><ol><li><p>创建·alpine-net·网络。您不需要<code>--driver bridge</code>标志，因为它是默认标志，但是此示例显示了如何指定它。</p><pre class="line-numbers language-bash"><code class="language-bash">$ docker network create --driver bridge alpine-net<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>列出Docker的网络：</p><pre class="line-numbers language-bash"><code class="language-bash">$ docker network <span class="token function">ls</span>

NETWORK ID          NAME                DRIVER              SCOPE
e9261a8c9a19        alpine-net          bridge              local
17e324f45964        bridge              bridge              local
6ed54d316334        host                host                local
7092879f2cc8        none                null                local<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>检查·alpine-net·网络。这显示了它的IP地址以及没有容器连接到它：</p><pre class="line-numbers language-bash"><code class="language-bash">$ docker network inspect alpine-net

<span class="token punctuation">[</span>
 <span class="token punctuation">{</span>
     <span class="token string">"Name"</span><span class="token keyword">:</span> <span class="token string">"alpine-net"</span>,
     <span class="token string">"Id"</span><span class="token keyword">:</span> <span class="token string">"e9261a8c9a19eabf2bf1488bf5f208b99b1608f330cff585c273d39481c9b0ec"</span>,
     <span class="token string">"Created"</span><span class="token keyword">:</span> <span class="token string">"2017-09-25T21:38:12.620046142Z"</span>,
     <span class="token string">"Scope"</span><span class="token keyword">:</span> <span class="token string">"local"</span>,
     <span class="token string">"Driver"</span><span class="token keyword">:</span> <span class="token string">"bridge"</span>,
     <span class="token string">"EnableIPv6"</span><span class="token keyword">:</span> false,
     <span class="token string">"IPAM"</span><span class="token keyword">:</span> <span class="token punctuation">{</span>
         <span class="token string">"Driver"</span><span class="token keyword">:</span> <span class="token string">"default"</span>,
         <span class="token string">"Options"</span><span class="token keyword">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>,
         <span class="token string">"Config"</span><span class="token keyword">:</span> <span class="token punctuation">[</span>
             <span class="token punctuation">{</span>
                 <span class="token string">"Subnet"</span><span class="token keyword">:</span> <span class="token string">"172.18.0.0/16"</span>,
                 <span class="token string">"Gateway"</span><span class="token keyword">:</span> <span class="token string">"172.18.0.1"</span>
             <span class="token punctuation">}</span>
         <span class="token punctuation">]</span>
     <span class="token punctuation">}</span>,
     <span class="token string">"Internal"</span><span class="token keyword">:</span> false,
     <span class="token string">"Attachable"</span><span class="token keyword">:</span> false,
     <span class="token string">"Containers"</span><span class="token keyword">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>,
     <span class="token string">"Options"</span><span class="token keyword">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>,
     <span class="token string">"Labels"</span><span class="token keyword">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>请注意，这个网络的网关是172.18.0.1，与缺省网桥网络相反，后者的网关是172.17.0.1。 确切的 IP 地址在您的系统上可能不同。</p></li><li><p>创建四个容器。注意<code>--network</code>标志。在<code>docker run</code>命令期间，您只能连接到一个网络，因此需要在之后使用 <code>docker network connect</code>将 <code>alpine4</code>连接到桥接网络。</p><pre class="line-numbers language-bash"><code class="language-bash">$ docker run -dit --name alpine1 --network alpine-net alpine ash

$ docker run -dit --name alpine2 --network alpine-net alpine ash

$ docker run -dit --name alpine3 alpine ash

$ docker run -dit --name alpine4 --network alpine-net alpine ash

$ docker network connect bridge alpine4<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>验证所有容器都在运行：</p><pre class="line-numbers language-bash"><code class="language-bash">$ docker container <span class="token function">ls</span>

CONTAINER ID        IMAGE               COMMAND             CREATED              STATUS              PORTS               NAMES
156849ccd902        alpine              <span class="token string">"ash"</span>               41 seconds ago       Up 41 seconds                           alpine4
fa1340b8d83e        alpine              <span class="token string">"ash"</span>               51 seconds ago       Up 51 seconds                           alpine3
a535d969081e        alpine              <span class="token string">"ash"</span>               About a minute ago   Up About a minute                       alpine2
0a02c449a6e9        alpine              <span class="token string">"ash"</span>               About a minute ago   Up About a minute                       alpine1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>检查<code>bridge</code>网络和<code>alpine-net</code>网络：</p><pre class="line-numbers language-bash"><code class="language-bash">$ docker network inspect bridge

<span class="token punctuation">[</span>
 <span class="token punctuation">{</span>
     <span class="token string">"Name"</span><span class="token keyword">:</span> <span class="token string">"bridge"</span>,
     <span class="token string">"Id"</span><span class="token keyword">:</span> <span class="token string">"17e324f459648a9baaea32b248d3884da102dde19396c25b30ec800068ce6b10"</span>,
     <span class="token string">"Created"</span><span class="token keyword">:</span> <span class="token string">"2017-06-22T20:27:43.826654485Z"</span>,
     <span class="token string">"Scope"</span><span class="token keyword">:</span> <span class="token string">"local"</span>,
     <span class="token string">"Driver"</span><span class="token keyword">:</span> <span class="token string">"bridge"</span>,
     <span class="token string">"EnableIPv6"</span><span class="token keyword">:</span> false,
     <span class="token string">"IPAM"</span><span class="token keyword">:</span> <span class="token punctuation">{</span>
         <span class="token string">"Driver"</span><span class="token keyword">:</span> <span class="token string">"default"</span>,
         <span class="token string">"Options"</span><span class="token keyword">:</span> null,
         <span class="token string">"Config"</span><span class="token keyword">:</span> <span class="token punctuation">[</span>
             <span class="token punctuation">{</span>
                 <span class="token string">"Subnet"</span><span class="token keyword">:</span> <span class="token string">"172.17.0.0/16"</span>,
                 <span class="token string">"Gateway"</span><span class="token keyword">:</span> <span class="token string">"172.17.0.1"</span>
             <span class="token punctuation">}</span>
         <span class="token punctuation">]</span>
     <span class="token punctuation">}</span>,
     <span class="token string">"Internal"</span><span class="token keyword">:</span> false,
     <span class="token string">"Attachable"</span><span class="token keyword">:</span> false,
     <span class="token string">"Containers"</span><span class="token keyword">:</span> <span class="token punctuation">{</span>
         <span class="token string">"156849ccd902b812b7d17f05d2d81532ccebe5bf788c9a79de63e12bb92fc621"</span><span class="token keyword">:</span> <span class="token punctuation">{</span>
             <span class="token string">"Name"</span><span class="token keyword">:</span> <span class="token string">"alpine4"</span>,
             <span class="token string">"EndpointID"</span><span class="token keyword">:</span> <span class="token string">"7277c5183f0da5148b33d05f329371fce7befc5282d2619cfb23690b2adf467d"</span>,
             <span class="token string">"MacAddress"</span><span class="token keyword">:</span> <span class="token string">"02:42:ac:11:00:03"</span>,
             <span class="token string">"IPv4Address"</span><span class="token keyword">:</span> <span class="token string">"172.17.0.3/16"</span>,
             <span class="token string">"IPv6Address"</span><span class="token keyword">:</span> <span class="token string">""</span>
         <span class="token punctuation">}</span>,
         <span class="token string">"fa1340b8d83eef5497166951184ad3691eb48678a3664608ec448a687b047c53"</span><span class="token keyword">:</span> <span class="token punctuation">{</span>
             <span class="token string">"Name"</span><span class="token keyword">:</span> <span class="token string">"alpine3"</span>,
             <span class="token string">"EndpointID"</span><span class="token keyword">:</span> <span class="token string">"5ae767367dcbebc712c02d49556285e888819d4da6b69d88cd1b0d52a83af95f"</span>,
             <span class="token string">"MacAddress"</span><span class="token keyword">:</span> <span class="token string">"02:42:ac:11:00:02"</span>,
             <span class="token string">"IPv4Address"</span><span class="token keyword">:</span> <span class="token string">"172.17.0.2/16"</span>,
             <span class="token string">"IPv6Address"</span><span class="token keyword">:</span> <span class="token string">""</span>
         <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>,
     <span class="token string">"Options"</span><span class="token keyword">:</span> <span class="token punctuation">{</span>
         <span class="token string">"com.docker.network.bridge.default_bridge"</span><span class="token keyword">:</span> <span class="token string">"true"</span>,
         <span class="token string">"com.docker.network.bridge.enable_icc"</span><span class="token keyword">:</span> <span class="token string">"true"</span>,
         <span class="token string">"com.docker.network.bridge.enable_ip_masquerade"</span><span class="token keyword">:</span> <span class="token string">"true"</span>,
         <span class="token string">"com.docker.network.bridge.host_binding_ipv4"</span><span class="token keyword">:</span> <span class="token string">"0.0.0.0"</span>,
         <span class="token string">"com.docker.network.bridge.name"</span><span class="token keyword">:</span> <span class="token string">"docker0"</span>,
         <span class="token string">"com.docker.network.driver.mtu"</span><span class="token keyword">:</span> <span class="token string">"1500"</span>
     <span class="token punctuation">}</span>,
     <span class="token string">"Labels"</span><span class="token keyword">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>容器<code>alpine3</code>和<code>alpine4</code>连接到<code>bridge</code>网络。</p><pre class="line-numbers language-bash"><code class="language-bash">$ docker network inspect alpine-net

<span class="token punctuation">[</span>
 <span class="token punctuation">{</span>
     <span class="token string">"Name"</span><span class="token keyword">:</span> <span class="token string">"alpine-net"</span>,
     <span class="token string">"Id"</span><span class="token keyword">:</span> <span class="token string">"e9261a8c9a19eabf2bf1488bf5f208b99b1608f330cff585c273d39481c9b0ec"</span>,
     <span class="token string">"Created"</span><span class="token keyword">:</span> <span class="token string">"2017-09-25T21:38:12.620046142Z"</span>,
     <span class="token string">"Scope"</span><span class="token keyword">:</span> <span class="token string">"local"</span>,
     <span class="token string">"Driver"</span><span class="token keyword">:</span> <span class="token string">"bridge"</span>,
     <span class="token string">"EnableIPv6"</span><span class="token keyword">:</span> false,
     <span class="token string">"IPAM"</span><span class="token keyword">:</span> <span class="token punctuation">{</span>
         <span class="token string">"Driver"</span><span class="token keyword">:</span> <span class="token string">"default"</span>,
         <span class="token string">"Options"</span><span class="token keyword">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>,
         <span class="token string">"Config"</span><span class="token keyword">:</span> <span class="token punctuation">[</span>
             <span class="token punctuation">{</span>
                 <span class="token string">"Subnet"</span><span class="token keyword">:</span> <span class="token string">"172.18.0.0/16"</span>,
                 <span class="token string">"Gateway"</span><span class="token keyword">:</span> <span class="token string">"172.18.0.1"</span>
             <span class="token punctuation">}</span>
         <span class="token punctuation">]</span>
     <span class="token punctuation">}</span>,
     <span class="token string">"Internal"</span><span class="token keyword">:</span> false,
     <span class="token string">"Attachable"</span><span class="token keyword">:</span> false,
     <span class="token string">"Containers"</span><span class="token keyword">:</span> <span class="token punctuation">{</span>
         <span class="token string">"0a02c449a6e9a15113c51ab2681d72749548fb9f78fae4493e3b2e4e74199c4a"</span><span class="token keyword">:</span> <span class="token punctuation">{</span>
             <span class="token string">"Name"</span><span class="token keyword">:</span> <span class="token string">"alpine1"</span>,
             <span class="token string">"EndpointID"</span><span class="token keyword">:</span> <span class="token string">"c83621678eff9628f4e2d52baf82c49f974c36c05cba152db4c131e8e7a64673"</span>,
             <span class="token string">"MacAddress"</span><span class="token keyword">:</span> <span class="token string">"02:42:ac:12:00:02"</span>,
             <span class="token string">"IPv4Address"</span><span class="token keyword">:</span> <span class="token string">"172.18.0.2/16"</span>,
             <span class="token string">"IPv6Address"</span><span class="token keyword">:</span> <span class="token string">""</span>
         <span class="token punctuation">}</span>,
         <span class="token string">"156849ccd902b812b7d17f05d2d81532ccebe5bf788c9a79de63e12bb92fc621"</span><span class="token keyword">:</span> <span class="token punctuation">{</span>
             <span class="token string">"Name"</span><span class="token keyword">:</span> <span class="token string">"alpine4"</span>,
             <span class="token string">"EndpointID"</span><span class="token keyword">:</span> <span class="token string">"058bc6a5e9272b532ef9a6ea6d7f3db4c37527ae2625d1cd1421580fd0731954"</span>,
             <span class="token string">"MacAddress"</span><span class="token keyword">:</span> <span class="token string">"02:42:ac:12:00:04"</span>,
             <span class="token string">"IPv4Address"</span><span class="token keyword">:</span> <span class="token string">"172.18.0.4/16"</span>,
             <span class="token string">"IPv6Address"</span><span class="token keyword">:</span> <span class="token string">""</span>
         <span class="token punctuation">}</span>,
         <span class="token string">"a535d969081e003a149be8917631215616d9401edcb4d35d53f00e75ea1db653"</span><span class="token keyword">:</span> <span class="token punctuation">{</span>
             <span class="token string">"Name"</span><span class="token keyword">:</span> <span class="token string">"alpine2"</span>,
             <span class="token string">"EndpointID"</span><span class="token keyword">:</span> <span class="token string">"198f3141ccf2e7dba67bce358d7b71a07c5488e3867d8b7ad55a4c695ebb8740"</span>,
             <span class="token string">"MacAddress"</span><span class="token keyword">:</span> <span class="token string">"02:42:ac:12:00:03"</span>,
             <span class="token string">"IPv4Address"</span><span class="token keyword">:</span> <span class="token string">"172.18.0.3/16"</span>,
             <span class="token string">"IPv6Address"</span><span class="token keyword">:</span> <span class="token string">""</span>
         <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>,
     <span class="token string">"Options"</span><span class="token keyword">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>,
     <span class="token string">"Labels"</span><span class="token keyword">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>容器<code>alpine1</code>，<code>alpine2</code>和<code>alpine4</code>连接到 <code>alpine-net</code>网络。</p></li><li><p>在用户定义网络<code>alpine-net</code>，容器不仅可以通过IP地址进行通信，还可以将容器名称解析为IP地址。此功能称为<strong>自动服务发现</strong>。让我们连接<code>alpine1</code>并测试一下。<code>alpine1</code>应该能够解析 <code>alpine2</code>和<code>alpine4</code>（以及<code>alpine1</code>本身）为IP地址。</p><pre class="line-numbers language-bash"><code class="language-bash">$ docker container attach alpine1

<span class="token comment" spellcheck="true"># ping -c 2 alpine2</span>

PING alpine2 <span class="token punctuation">(</span>172.18.0.3<span class="token punctuation">)</span>: 56 data bytes
64 bytes from 172.18.0.3: seq<span class="token operator">=</span>0 ttl<span class="token operator">=</span>64 time<span class="token operator">=</span>0.085 ms
64 bytes from 172.18.0.3: seq<span class="token operator">=</span>1 ttl<span class="token operator">=</span>64 time<span class="token operator">=</span>0.090 ms

\--- alpine2 <span class="token function">ping</span> statistics ---
2 packets transmitted, 2 packets received, 0% packet loss
round-trip min/avg/max <span class="token operator">=</span> 0.085/0.087/0.090 ms

<span class="token comment" spellcheck="true"># ping -c 2 alpine4</span>

PING alpine4 <span class="token punctuation">(</span>172.18.0.4<span class="token punctuation">)</span>: 56 data bytes
64 bytes from 172.18.0.4: seq<span class="token operator">=</span>0 ttl<span class="token operator">=</span>64 time<span class="token operator">=</span>0.076 ms
64 bytes from 172.18.0.4: seq<span class="token operator">=</span>1 ttl<span class="token operator">=</span>64 time<span class="token operator">=</span>0.091 ms

\--- alpine4 <span class="token function">ping</span> statistics ---
2 packets transmitted, 2 packets received, 0% packet loss
round-trip min/avg/max <span class="token operator">=</span> 0.076/0.083/0.091 ms

<span class="token comment" spellcheck="true"># ping -c 2 alpine1</span>

PING alpine1 <span class="token punctuation">(</span>172.18.0.2<span class="token punctuation">)</span>: 56 data bytes
64 bytes from 172.18.0.2: seq<span class="token operator">=</span>0 ttl<span class="token operator">=</span>64 time<span class="token operator">=</span>0.026 ms
64 bytes from 172.18.0.2: seq<span class="token operator">=</span>1 ttl<span class="token operator">=</span>64 time<span class="token operator">=</span>0.054 ms

\--- alpine1 <span class="token function">ping</span> statistics ---
2 packets transmitted, 2 packets received, 0% packet loss
round-trip min/avg/max <span class="token operator">=</span> 0.026/0.040/0.054 ms<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>从<code>alpine1</code>，您根本无法连接<code>alpine3</code>，因为它不在<code>alpine-net</code>网络上。</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># ping -c 2 alpine3</span>

ping: bad address <span class="token string">'alpine3'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>不仅如此，您也无法通过<code>alpine3</code>的IP地址，从<code>alpine1</code>连接到<code>alpine3</code>。回顾网络的<code>docker network inspect</code>输出 <code>bridge</code>，找到<code>alpine3</code>的IP地址：<code>172.17.0.2</code>尝试ping通它。</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># ping -c 2 172.17.0.2</span>

PING 172.17.0.2 <span class="token punctuation">(</span>172.17.0.2<span class="token punctuation">)</span>: 56 data bytes

\--- 172.17.0.2 <span class="token function">ping</span> statistics ---
2 packets transmitted, 0 packets received, 100% packet loss<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>使用分离序列从 <code>alpine1</code>中分离， <code>CTRL+ p</code> <code>CTRL+ q</code>（按住 CTRL，键入 p，然后是 q）。</p></li><li><p>请记住，<code>alpine4</code>已连接到默认<code>bridge</code>网络和<code>alpine-net</code>。它应该能够到达所有其他容器。但是，您将需要<code>alpine3</code>的IP地址进行寻址。附加到它并运行测试。</p><pre class="line-numbers language-bash"><code class="language-bash">$ docker container attach alpine4

<span class="token comment" spellcheck="true"># ping -c 2 alpine1</span>

PING alpine1 <span class="token punctuation">(</span>172.18.0.2<span class="token punctuation">)</span>: 56 data bytes
64 bytes from 172.18.0.2: seq<span class="token operator">=</span>0 ttl<span class="token operator">=</span>64 time<span class="token operator">=</span>0.074 ms
64 bytes from 172.18.0.2: seq<span class="token operator">=</span>1 ttl<span class="token operator">=</span>64 time<span class="token operator">=</span>0.082 ms

\--- alpine1 <span class="token function">ping</span> statistics ---
2 packets transmitted, 2 packets received, 0% packet loss
round-trip min/avg/max <span class="token operator">=</span> 0.074/0.078/0.082 ms

<span class="token comment" spellcheck="true"># ping -c 2 alpine2</span>

PING alpine2 <span class="token punctuation">(</span>172.18.0.3<span class="token punctuation">)</span>: 56 data bytes
64 bytes from 172.18.0.3: seq<span class="token operator">=</span>0 ttl<span class="token operator">=</span>64 time<span class="token operator">=</span>0.075 ms
64 bytes from 172.18.0.3: seq<span class="token operator">=</span>1 ttl<span class="token operator">=</span>64 time<span class="token operator">=</span>0.080 ms

\--- alpine2 <span class="token function">ping</span> statistics ---
2 packets transmitted, 2 packets received, 0% packet loss
round-trip min/avg/max <span class="token operator">=</span> 0.075/0.077/0.080 ms

<span class="token comment" spellcheck="true"># ping -c 2 alpine3</span>
ping: bad address <span class="token string">'alpine3'</span>

<span class="token comment" spellcheck="true"># ping -c 2 172.17.0.2</span>

PING 172.17.0.2 <span class="token punctuation">(</span>172.17.0.2<span class="token punctuation">)</span>: 56 data bytes
64 bytes from 172.17.0.2: seq<span class="token operator">=</span>0 ttl<span class="token operator">=</span>64 time<span class="token operator">=</span>0.089 ms
64 bytes from 172.17.0.2: seq<span class="token operator">=</span>1 ttl<span class="token operator">=</span>64 time<span class="token operator">=</span>0.075 ms

\--- 172.17.0.2 <span class="token function">ping</span> statistics ---
2 packets transmitted, 2 packets received, 0% packet loss
round-trip min/avg/max <span class="token operator">=</span> 0.075/0.082/0.089 ms

<span class="token comment" spellcheck="true"># ping -c 2 alpine4</span>

PING alpine4 <span class="token punctuation">(</span>172.18.0.4<span class="token punctuation">)</span>: 56 data bytes
64 bytes from 172.18.0.4: seq<span class="token operator">=</span>0 ttl<span class="token operator">=</span>64 time<span class="token operator">=</span>0.033 ms
64 bytes from 172.18.0.4: seq<span class="token operator">=</span>1 ttl<span class="token operator">=</span>64 time<span class="token operator">=</span>0.064 ms

\--- alpine4 <span class="token function">ping</span> statistics ---
2 packets transmitted, 2 packets received, 0% packet loss
round-trip min/avg/max <span class="token operator">=</span> 0.033/0.048/0.064 ms<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>作为最终测试，请通过ping确保您的容器都可以连接到互联网<code>google.com</code>。您已经接入<code>alpine4</code>，因此请从那里开始尝试。接下来，断开alpine4并连接到alpine3 （仅连接到bridge网络）并重试。最后，连接到alpine1（仅连接到alpine-net网络），然后重试。</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># ping -c 2 google.com</span>

PING google.com <span class="token punctuation">(</span>172.217.3.174<span class="token punctuation">)</span>: 56 data bytes
64 bytes from 172.217.3.174: seq<span class="token operator">=</span>0 ttl<span class="token operator">=</span>41 time<span class="token operator">=</span>9.778 ms
64 bytes from 172.217.3.174: seq<span class="token operator">=</span>1 ttl<span class="token operator">=</span>41 time<span class="token operator">=</span>9.634 ms

\--- google.com <span class="token function">ping</span> statistics ---
2 packets transmitted, 2 packets received, 0% packet loss
round-trip min/avg/max <span class="token operator">=</span> 9.634/9.706/9.778 ms

CTRL+p CTRL+q

$ docker container attach alpine3

<span class="token comment" spellcheck="true"># ping -c 2 google.com</span>

PING google.com <span class="token punctuation">(</span>172.217.3.174<span class="token punctuation">)</span>: 56 data bytes
64 bytes from 172.217.3.174: seq<span class="token operator">=</span>0 ttl<span class="token operator">=</span>41 time<span class="token operator">=</span>9.706 ms
64 bytes from 172.217.3.174: seq<span class="token operator">=</span>1 ttl<span class="token operator">=</span>41 time<span class="token operator">=</span>9.851 ms

\--- google.com <span class="token function">ping</span> statistics ---
2 packets transmitted, 2 packets received, 0% packet loss
round-trip min/avg/max <span class="token operator">=</span> 9.706/9.778/9.851 ms

CTRL+p CTRL+q

$ docker container attach alpine1

<span class="token comment" spellcheck="true"># ping -c 2 google.com</span>

PING google.com <span class="token punctuation">(</span>172.217.3.174<span class="token punctuation">)</span>: 56 data bytes
64 bytes from 172.217.3.174: seq<span class="token operator">=</span>0 ttl<span class="token operator">=</span>41 time<span class="token operator">=</span>9.606 ms
64 bytes from 172.217.3.174: seq<span class="token operator">=</span>1 ttl<span class="token operator">=</span>41 time<span class="token operator">=</span>9.603 ms

\--- google.com <span class="token function">ping</span> statistics ---
2 packets transmitted, 2 packets received, 0% packet loss
round-trip min/avg/max <span class="token operator">=</span> 9.603/9.604/9.606 ms

CTRL+p CTRL+q<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>停止并卸下所有容器和alpine-net网络。</p><pre class="line-numbers language-bash"><code class="language-bash">$ docker container stop alpine1 alpine2 alpine3 alpine4

$ docker container <span class="token function">rm</span> alpine1 alpine2 alpine3 alpine4

$ docker network <span class="token function">rm</span> alpine-net<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ol><script>document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });</script></div><hr><div class="reprint" id="reprint-statement"><div class="reprint__author"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-user">文章作者:</i></span> <span class="reprint-info"><a href="/about" rel="external nofollow noreferrer">Baymax</a></span></div><div class="reprint__type"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-link">文章链接:</i></span> <span class="reprint-info"><a href="https://baymax.tips/posts/27457.html">https://baymax.tips/posts/27457.html</a></span></div><div class="reprint__notice"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-copyright">版权声明:</i></span> <span class="reprint-info">本博客所有文章除特別声明外，均采用 <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a> 许可协议。转载请注明来源 <a href="/about" target="_blank">Baymax</a> !</span></div></div><script async defer>document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }</script><div class="tag_share" style="display:block"><div class="post-meta__tag-list" style="display:inline-block"><div class="article-tag"><a href="/tags/Docker/"><span class="chip bg-color">Docker</span></a> <a href="/tags/%E5%AE%B9%E5%99%A8%E6%9C%8D%E5%8A%A1/"><span class="chip bg-color">容器服务</span></a></div></div><div class="post_share" style="zoom:80%;width:fit-content;display:inline-block;float:right;margin:-.15rem 0"><link rel="stylesheet" href="/libs/share/css/share.min.css"><div id="article-share"><div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div><script src="/libs/share/js/social-share.min.js"></script></div></div></div><style>#reward{margin:40px 0;text-align:center}#reward .reward-link{font-size:1.4rem;line-height:38px}#reward .btn-floating:hover{box-shadow:0 6px 12px rgba(0,0,0,.2),0 5px 15px rgba(0,0,0,.2)}#rewardModal{width:320px;height:350px}#rewardModal .reward-title{margin:15px auto;padding-bottom:5px}#rewardModal .modal-content{padding:10px}#rewardModal .close{position:absolute;right:15px;top:15px;color:rgba(0,0,0,.5);font-size:1.3rem;line-height:20px;cursor:pointer}#rewardModal .close:hover{color:#ef5350;transform:scale(1.3);-moz-transform:scale(1.3);-webkit-transform:scale(1.3);-o-transform:scale(1.3)}#rewardModal .reward-tabs{margin:0 auto;width:210px}.reward-tabs .tabs{height:38px;margin:10px auto;padding-left:0}.reward-content ul{padding-left:0!important}.reward-tabs .tabs .tab{height:38px;line-height:38px}.reward-tabs .tab a{color:#fff;background-color:#ccc}.reward-tabs .tab a:hover{background-color:#ccc;color:#fff}.reward-tabs .wechat-tab .active{color:#fff!important;background-color:#22ab38!important}.reward-tabs .alipay-tab .active{color:#fff!important;background-color:#019fe8!important}.reward-tabs .reward-img{width:210px;height:210px}</style><div id="reward"><a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a><div id="rewardModal" class="modal"><div class="modal-content"><a class="close modal-close"><i class="fas fa-times"></i></a><h4 class="reward-title">你的赏识是我前进的动力</h4><div class="reward-content"><div class="reward-tabs"><ul class="tabs row"><li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li><li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li></ul><div id="alipay"><img src="/medias/loading.gif" data-original="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码"></div><div id="wechat"><img src="/medias/loading.gif" data-original="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码"></div></div></div></div></div></div><script>$(function(){$(".tabs").tabs()})</script></div></div><link rel="stylesheet" href="/libs/gitalk/gitalk.css"><link rel="stylesheet" href="/css/my-gitalk.css"><div class="card gitalk-card" data-aos="fade-up"><div class="comment_headling" style="font-size:20px;font-weight:700;position:relative;padding-left:20px;top:15px;padding-bottom:5px"><i class="fas fa-comments fa-fw" aria-hidden="true"></i> <span>评论</span></div><div id="gitalk-container" class="card-content"></div></div><script src="/libs/gitalk/gitalk.min.js"></script><script>let gitalk = new Gitalk({
        clientID: '409bf7f6a2a9bcc0f9e6',
        clientSecret: '1cafe266ac7e32c87692df3d52b9a16b773e8c31',
        repo: 'baymax-tips.github.io',
        owner: 'baymax-tips',
        admin: "baymax-tips",
        id: '2020-05-22T16-25-35',
        distractionFreeMode: false  // Facebook-like distraction free mode
    });

    gitalk.render('gitalk-container');</script><article id="prenext-posts" class="prev-next articles"><div class="row article-row"><div class="article col s12 m6" data-aos="fade-up"><div class="article-badge left-badge text-color"><i class="fas fa-chevron-left"></i> &nbsp;上一篇</div><div class="card"><a href="/posts/11593.html"><div class="card-image"><img src="/medias/loading.gif" data-original="/medias/featureimages/18.jpg" class="responsive-img" alt="Docker入门系列  5. Docker 容器网络的概念及网络配置 覆盖网络"> <span class="card-title">Docker入门系列 5. Docker 容器网络的概念及网络配置 覆盖网络</span></div></a><div class="card-content article-content"><div class="summary block-with-text">1. 使用覆盖网络覆盖网络驱动程序在多个 Docker 守护进程主机之间创建一个分布式网络。 这个网络位于(覆盖)主机特定网络的顶部，允许连接到它的容器(包括群服务容器)在启用加密时进行安全通信。 Docker 透明地处理每个数据包与正确的</div><div class="publish-info"><span class="publish-date"><i class="far fa-clock fa-fw icon-date"></i> 2020-05-24</span><span class="publish-author"><i class="fas fa-bookmark fa-fw icon-category"></i> <a href="/categories/%E5%AE%B9%E5%99%A8%E6%9C%8D%E5%8A%A1/" class="post-category">容器服务</a></span></div></div><div class="card-action article-tags"><a href="/tags/Docker/"><span class="chip bg-color">Docker</span></a> <a href="/tags/%E5%AE%B9%E5%99%A8%E6%9C%8D%E5%8A%A1/"><span class="chip bg-color">容器服务</span></a></div></div></div><div class="article col s12 m6" data-aos="fade-up"><div class="article-badge right-badge text-color">下一篇&nbsp;<i class="fas fa-chevron-right"></i></div><div class="card"><a href="/posts/50310.html"><div class="card-image"><img src="/medias/loading.gif" data-original="/medias/featureimages/10.jpg" class="responsive-img" alt="Docker入门系列  3. Docker 容器网络的概念及网络配置 网络概述"> <span class="card-title">Docker入门系列 3. Docker 容器网络的概念及网络配置 网络概述</span></div></a><div class="card-content article-content"><div class="summary block-with-text">1. 网络概述  Docker容器和服务如此强大的原因之一是你可以将它们连接在一起，或将它们连接到非Docker工作负载。Docker容器和服务甚至不需要知道它们已部署在Docker上，也不必知道它们的对等对象是否也是Docker工作负载。</div><div class="publish-info"><span class="publish-date"><i class="far fa-clock fa-fw icon-date"></i> 2020-05-14</span><span class="publish-author"><i class="fas fa-bookmark fa-fw icon-category"></i> <a href="/categories/%E5%AE%B9%E5%99%A8%E6%9C%8D%E5%8A%A1/" class="post-category">容器服务</a></span></div></div><div class="card-action article-tags"><a href="/tags/Docker/"><span class="chip bg-color">Docker</span></a> <a href="/tags/%E5%AE%B9%E5%99%A8%E6%9C%8D%E5%8A%A1/"><span class="chip bg-color">容器服务</span></a></div></div></div></div></article></div><script src="/libs/codeBlock/codeBlockFuction.js"></script><script src="/libs/codeBlock/codeLang.js"></script><script src="/libs/codeBlock/codeCopy.js"></script><script src="/libs/codeBlock/codeShrink.js"></script><style>code[class*=language-],pre[class*=language-]{white-space:pre!important}</style></div><div id="toc-aside" class="expanded col l3 hide-on-med-and-down"><div class="toc-widget"><div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div><div id="toc-content"></div></div></div></div><div id="floating-toc-btn" class="hide-on-med-and-down"><a class="btn-floating btn-large bg-color"><i class="fas fa-list-ul"></i></a></div><script src="/libs/tocbot/tocbot.min.js"></script><script>$(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });</script></main><footer class="page-footer bg-color"><link rel="stylesheet" href="/libs/aplayer/APlayer.min.css"><style>.aplayer .aplayer-lrc p{display:none;font-size:12px;font-weight:700;line-height:16px!important}.aplayer .aplayer-lrc p.aplayer-lrc-current{display:none;font-size:15px;color:#42b983}.aplayer.aplayer-fixed.aplayer-narrow .aplayer-body{left:-66px!important}.aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover{left:0!important}</style><div><div class="row"><meting-js class="col l8 offset-l2 m10 offset-m1 s12" server="netease" type="playlist" id="503838841" fixed="true" autoplay theme="#42b983" loop order="random" preload="auto" volume="0.7" list-folded="true"></meting-js></div></div><script src="/libs/aplayer/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script><div class="container row center-align" style="margin-bottom:0!important"><div class="col s12 m8 l8 copy-right">Copyright&nbsp;&copy; <span id="year">2019</span> <a href="/about" target="_blank">Baymax</a> |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a> |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a><br><span id="busuanzi_container_site_pv">|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span id="busuanzi_value_site_pv" class="white-color"></span>&nbsp;次</span> <span id="busuanzi_container_site_uv">|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span id="busuanzi_value_site_uv" class="white-color"></span>&nbsp;人</span><br><br></div><div class="col s12 m4 l4 social-link social-statis"><a href="https://github.com/baymax-tips" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50"><i class="fab fa-github"></i></a><a href="mailto:baymax.tips@gmail.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50"><i class="fas fa-envelope-open"></i></a><a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1104559822" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 1104559822" data-position="top" data-delay="50"><i class="fab fa-qq"></i></a><a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50"><i class="fas fa-rss"></i></a></div></div></footer><div class="progress-bar"></div><div id="searchModal" class="modal"><div class="modal-content"><div class="search-header"><span class="title"><i class="fas fa-search"></i> &nbsp;&nbsp;搜索</span> <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字" class="search-input"></div><div id="searchResult"></div></div></div><script src="/js/search.js"></script><script>$(function(){searchFunc("/search.xml","searchInput","searchResult")})</script><div id="backTop" class="top-scroll"><a class="btn-floating btn-large waves-effect waves-light" href="#!"><i class="fas fa-arrow-up"></i></a></div><script src="/libs/materialize/materialize.min.js"></script><script src="/libs/masonry/masonry.pkgd.min.js"></script><script src="/libs/aos/aos.js"></script><script src="/libs/scrollprogress/scrollProgress.min.js"></script><script src="/libs/lightGallery/js/lightgallery-all.min.js"></script><script src="/js/matery.js"></script><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?0c003470f128eba63e9f505647bc17bd";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script><script src="/libs/others/clicklove.js" async></script><script async src="/libs/others/busuanzi.pure.mini.js"></script><script src="/libs/background/ribbon-dynamic.js" async></script><script src="/libs/instantpage/instantpage.js" type="module"></script><script>window.imageLazyLoadSetting={isSPA:!1,processImages:null}</script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})})</script><script>!function(n){n.imageLazyLoadSetting.processImages=i;var e=n.imageLazyLoadSetting.isSPA,r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function i(){e&&(r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var t,a=0;a<r.length;a++)0<=(t=r[a].getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(n.innerHeight+240||document.documentElement.clientHeight+240)&&function(){var t,e,n,i,o=r[a];t=o,e=function(){r=r.filter(function(t){return o!==t})},n=new Image,i=t.getAttribute("data-original"),n.onload=function(){t.src=i,e()},n.src=i}()}i(),n.addEventListener("scroll",function(){var t,e;t=i,e=n,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)})}(this)</script></body></html>